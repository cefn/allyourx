<!DOCTYPE html SYSTEM "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Editor</title>
        <link rel="stylesheet" href="../test/js/unit.css"></link>
        <link rel="stylesheet" href="../js/ally_editor_raw.css"></link>
        <script type="text/javascript" src="../lib/jquery-ui-1.7.2/jquery-1.3.2.js"></script>
        <script type="text/javascript" src="../lib/livequery-1.0.3/jquery.livequery.js"></script>
        <script type="text/javascript" src="../lib/jquery-ui-1.7.2/ui/ui.core.js"></script>
		<script type="text/javascript" src="../lib/guid0/guid0.js"></script>
		<script type="text/javascript" src="../lib/jshashtable/jshashtable-2.1.js"></script>
        <script type="text/javascript" src="../js/yourx_bootstrap.js"></script>
        <script type="text/javascript" src="../js/yourx.js"></script>
        <script type="text/javascript" src="../js/yourx_caret.js"></script>
        <script type="text/javascript" src="../js/ally.js"></script>
    </head>
	<script type="text/javascript">
        //<![CDATA[
			$(function(){
				var session = {};
				
				/** Set up a rule, thingy and example editor.*/
				//load the grammar
				session.rootrule = YOURX.ThingyUtil.url2rule("../test/schema/yourx/examples.001/team.001.rng");
				//create an empty thingytree
				session.rootthingy = new YOURX.RootThingy(); //root thingy matches root node (empty container)
				//create an editor to handle DOM interactions
				session.editor = new ALLY.RawEditor();
				//use the editor to bind the empty thingytree 
				session.editor.trackThingy(session.rootthingy);
				//get the wrapper dom element maintained by the editor
				session.rootwrapper = session.editor.getBoundSelection(session.rootthingy);
				//add the wrapper to a DOM element in the document
				session.rootwrapper.appendTo("#editor");
				
				/** The following would normally be managed by an editor controlling caret assignment. */				
				
				//create a caret to manage thingytree validation
				session.rootcaret = new YOURX.OperationCaret(session.rootrule,session.rootthingy);
				
				//make root's immediate descendants valid (assuming this requires no interaction)
				session.rootcaret.shallowFix();

				//repeat shallowfix for next child (assuming this requires no interaction)
				session.docthingy = session.rootthingy.getChildren()[0];
				session.docrule = session.rootrule.getChildren()[0];
				session.doccaret = new YOURX.OperationCaret(session.docrule,session.docthingy);
				session.doccaret.shallowFix();
				
			});
        //]]>		
	</script>
    <body>
    	<p>
			Visit <a href="../test/js/unit.html">unit.html</a> for concrete progress on codebase and its capabilities.
    		This editor file is used for interactive testing only occasionally and can therefore be well behind HEAD. 
    	</p>
    	<div id="editor"></div>
    </body>
</html>
